# RPA 流程定义文档 (PDD) 模板



项目名称： [例如：财务部-发票自动校验机器人]

流程名称： [例如：Invoice_Processing_01]

版本号： 1.0

日期： 202X-XX-XX

------



## 1. 文档控制 (Document Control)





### 1.1 版本记录



| **版本** | **日期**   | **修改人**      | **修改描述**             |
| -------- | ---------- | --------------- | ------------------------ |
| 0.1      | 2023-10-01 | 张三 (BA)       | 初稿创建                 |
| 1.0      | 2023-10-05 | 李四 (业务主管) | 确认业务规则，正式版发布 |



### 1.2 审批签字 (Sign-off)



*签署此文档意味着业务部门确认文档中的流程描述完全准确，并同意以此作为开发验收的标准。*

| **角色**                       | **姓名** | **职位** | **签字/日期** |
| ------------------------------ | -------- | -------- | ------------- |
| **流程所有者 (Process Owner)** | [姓名]   | 财务经理 |               |
| **业务分析师 (BA)**            | [姓名]   | RPA BA   |               |
| **项目经理 (PM)**              | [姓名]   | RPA PM   |               |

------



## 2. 流程概览 (Process Overview)





### 2.1 流程描述



*简要描述该流程目前是做什么的，目的是什么。*

> **示例：** 财务人员每天从指定邮箱下载供应商发票 PDF，读取其中的发票号和金额，登录 SAP 系统进行核对，最后将结果记录在 Excel 中。



### 2.2 关键指标 (Key Metrics)



| **指标项**               | **描述**                        | **备注**           |
| ------------------------ | ------------------------------- | ------------------ |
| **交易量 (Volume)**      | [例如：每天 500 单]             | 是否有季节性高峰？ |
| **处理频率 (Frequency)** | [例如：每日运行，上午 9 点启动] |                    |
| **平均处理时长 (AHT)**   | [例如：人工处理单笔需 5 分钟]   | 用于计算 ROI       |
| **SLA 要求**             | [例如：必须在当日 12:00 前完成] |                    |
| **错误率容忍度**         | [例如：0% 容错，必须 100% 准确] |                    |

------



## 3. 现有流程描述 (As-Is Process)



*这是文档最核心的部分。必须详细到“傻瓜式”的操作指南。*



### 3.1 流程图 (Process Map)



*(在此处插入 Visio 或 Draw.io 绘制的人工操作流程图)*



### 3.2 详细操作步骤 (Keystroke Level Details)



*请记录人工操作的每一步，包括鼠标点击、键盘输入、快捷键等。*

| **步骤 ID**  | **角色** | **应用程序** | **动作描述**                                           | **截图/附件** |
| ------------ | -------- | ------------ | ------------------------------------------------------ | ------------- |
| **Step 1.0** | 用户     | Outlook      | 打开 Outlook，在收件箱搜索主题包含“Invoice”的邮件。    | [图 1]        |
| **Step 1.1** | 用户     | Outlook      | 打开邮件附件 PDF，另存为到 `C:\Invoices\Todo` 文件夹。 | [图 2]        |
| **Step 2.0** | 用户     | SAP GUI      | 双击桌面 SAP 图标，输入用户名和密码登录。              | [图 3]        |
| **Step 2.1** | 用户     | SAP GUI      | 输入 T-Code `MIRO` 并回车。                            | [图 4]        |
| **Step ...** | ...      | ...          | ...                                                    | ...           |

*注：截图必须清晰，重点字段需红框标出。*

------



## 4. 目标流程设计 (To-Be Process)



*描述引入 RPA 机器人后，人与机器人如何分工。*



### 4.1 自动化流程图



*(在此处插入 RPA 运行逻辑图，需展示机器人逻辑判断点)*



### 4.2 人机协作模式 (Hwang-Robot Interaction)



- **机器人负责：** [例如：下载邮件、录入 SAP、发送报告]
- **人工负责：** [例如：准备基础数据 Excel、处理机器人抛出的异常单据、审核最终结果]



### 4.3 范围界定 (Scope)





#### 4.3.1 包含在内 (In-Scope)



- 标准的 PDF 发票处理。
- 登录 SAP 正式环境录入。



#### 4.3.2 不包含在内 (Out-Of-Scope)



- **手写**的发票扫描件（OCR 无法识别）。
- 邮件主题不规范的邮件。
- SAP 系统的密码重置（机器人不负责改密）。
- *[PM 提示：这里写得越清楚，项目后期扯皮越少]*

------



## 5. 业务规则与异常处理 (Business Rules & Exceptions)



*这是开发人员写 `If-Else` 代码和 `Try-Catch` 的依据。*



### 5.1 业务规则矩阵



| **规则 ID** | **规则名称** | **逻辑描述**                                                 | **示例** |
| ----------- | ------------ | ------------------------------------------------------------ | -------- |
| **BR-01**   | 金额校验     | IF 发票金额 > 10,000, THEN 标记为“需人工复核”，跳过录入。    |          |
| **BR-02**   | 供应商匹配   | IF 供应商名称在系统不存在，THEN 发送邮件给采购员，并停止该单处理。 |          |



### 5.2 异常处理策略 (Exception Handling)



- **业务异常 (Business Exception):** 数据本身有问题（如数据缺失、格式错误）。
  - **处理动作：** [例如：截图 -> 记录日志 -> 发送告警邮件 -> 跳过当前单据 -> 继续下一单]
- **系统异常 (System Exception):** 应用程序崩溃、网络断开、页面加载超时。
  - **处理动作：** [例如：关闭应用 -> 重试 3 次 -> 若仍失败，发送紧急短信给运维 -> 停止机器人]

------



## 6. 输入/输出与环境 (Input/Output & Environment)





### 6.1 输入数据



- **文件类型：** Excel (.xlsx) / PDF / Email
- **存放路径：** `\\Server\Share\Input`
- **样本附件：** *(在此处附上脱敏后的真实数据样本，非常重要！)*



### 6.2 输出数据



- **处理结果报告：** 机器人运行结束后生成的 Excel 日志。
- **报告包含字段：** 时间戳、发票号、处理状态(成功/失败)、失败原因截图路径。



### 6.3 应用程序列表



| **应用程序名称** | **版本** | **访问方式** | **凭证 (Credential)**              |
| ---------------- | -------- | ------------ | ---------------------------------- |
| SAP ERP          | 7.5      | 客户端       | 机器人专用账号 (存于 Orchestrator) |
| Excel            | 365      | 本地安装     | 无                                 |

------



## 7. 附录 (Appendix)



- 相关的政策文档
- 详细的字段映射表 (Field Mapping Table)

------



### 💡 写给 PM 的 PDD 避坑指南：



1. **截图要“全”：** 所有的输入框、下拉菜单、报错弹窗，都要截图。不要只截局部，最好截全屏，让开发人员看到上下文。
2. **规则要“细”：** 不要写“验证数据有效性”这种模糊的话。要写“验证 A 列不为空且 B 列是 11 位数字”。
3. **异常要“悲观”：** 总是假设最坏的情况。比如：弹窗出现在意外的位置怎么办？网速慢了页面没加载出来怎么办？
4. **数据要“真”：** 附件里的 Excel 模板必须和生产环境完全一致（包括表头、隐藏列、格式）。哪怕多一个空格，机器人都会挂。